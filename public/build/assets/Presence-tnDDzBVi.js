import{a9 as I,r as f,s as E,a0 as T,y as g,z as O,d as S,a8 as U,aa as C,$ as P}from"./app-C45EbI6v.js";import{r as b}from"./Primitive-Bc-PNU7W.js";import{d as $,u as R}from"./index-BhAWeGCu.js";import{i as _}from"./index-ByHtNiOg.js";function V(){let t=document.activeElement;if(t==null)return null;for(;t!=null&&t.shadowRoot!=null&&t.shadowRoot.activeElement!=null;)t=t.shadowRoot.activeElement;return t}function q(t,e="reka"){return`${e}-${I?.()}`}function x(t,e){const s=f(t);function l(r){return e[s.value][r]??s.value}return{state:s,dispatch:r=>{s.value=l(r)}}}function D(t,e){const s=f({}),l=f("none"),v=f(t),r=t.value?"mounted":"unmounted";let u;const c=e.value?.ownerDocument.defaultView??$,{state:m,dispatch:i}=x(r,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),a=n=>{if(_){const o=new CustomEvent(n,{bubbles:!1,cancelable:!1});e.value?.dispatchEvent(o)}};E(t,async(n,o)=>{const N=o!==n;if(await T(),N){const A=l.value,d=h(e.value);n?(i("MOUNT"),a("enter"),d==="none"&&a("after-enter")):d==="none"||d==="undefined"||s.value?.display==="none"?(i("UNMOUNT"),a("leave"),a("after-leave")):o&&A!==d?(i("ANIMATION_OUT"),a("leave")):(i("UNMOUNT"),a("after-leave"))}},{immediate:!0});const p=n=>{const o=h(e.value),N=o.includes(CSS.escape(n.animationName)),A=m.value==="mounted"?"enter":"leave";if(n.target===e.value&&N&&(a(`after-${A}`),i("ANIMATION_END"),!v.value)){const d=e.value.style.animationFillMode;e.value.style.animationFillMode="forwards",u=c?.setTimeout(()=>{e.value?.style.animationFillMode==="forwards"&&(e.value.style.animationFillMode=d)})}n.target===e.value&&o==="none"&&i("ANIMATION_END")},y=n=>{n.target===e.value&&(l.value=h(e.value))},M=E(e,(n,o)=>{n?(s.value=getComputedStyle(n),n.addEventListener("animationstart",y),n.addEventListener("animationcancel",p),n.addEventListener("animationend",p)):(i("ANIMATION_END"),u!==void 0&&c?.clearTimeout(u),o?.removeEventListener("animationstart",y),o?.removeEventListener("animationcancel",p),o?.removeEventListener("animationend",p))},{immediate:!0}),w=E(m,()=>{const n=h(e.value);l.value=m.value==="mounted"?n:"none"});return g(()=>{M(),w()}),{isPresent:O(()=>["mounted","unmountSuspended"].includes(m.value))}}function h(t){return t&&getComputedStyle(t).animationName||"none"}var z=S({name:"Presence",props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(t,{slots:e,expose:s}){const{present:l,forceMount:v}=U(t),r=f(),{isPresent:u}=D(l,r);s({present:u});let c=e.default({present:u.value});c=b(c||[]);const m=C();if(c&&c?.length>1){const i=m?.parent?.type.name?`<${m.parent.type.name} />`:"component";throw new Error([`Detected an invalid children for \`${i}\` for  \`Presence\` component.`,"","Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.","You can apply a few solutions:",["Provide a single child element so that `presence` directive attach correctly.","Ensure the first child is an actual element instead of a raw text node or comment node."].map(a=>`  - ${a}`).join(`
`)].join(`
`))}return()=>v.value||l.value||u.value?P(e.default({present:u.value})[0],{ref:i=>{const a=R(i);return typeof a?.hasAttribute>"u"||(a?.hasAttribute("data-reka-popper-content-wrapper")?r.value=a.firstElementChild:r.value=a),a}}):null}});export{z as P,V as g,q as u};
