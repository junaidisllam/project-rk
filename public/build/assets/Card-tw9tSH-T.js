import{d as de,H as ue,r as p,U as G,z as J,s as he,x as ve,y as xe,e as r,b as e,c as g,l as j,f as b,n as x,g as u,i as a,t as o,C as pe,w as be,F as y,j as A,T as fe,q as _,M as k,o as l,E as ge}from"./app-CRBo5Voe.js";import{u as me,c as O,h as K,A as we,g as X,e as Y,f as ye,C as Z}from"./Heading-DtnxNrzF.js";import{c as te}from"./createLucideIcon-D5TOW6Nr.js";import{S as _e}from"./shield-check-Co63BVcJ.js";import{_ as ke}from"./_plugin-vue_export-helper-DrTGjmaW.js";const ee=te("Share2Icon",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);const N=te("ShoppingCartIcon",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Ce={class:"group relative mx-auto flex h-full w-full max-w-[170px] cursor-pointer flex-col will-change-transform"},ze={class:"relative z-10 shrink-0 transition-transform duration-300 ease-out group-hover:-translate-y-1"},je=["href"],Te={class:"relative w-full overflow-hidden rounded-r-sm bg-white shadow-sm"},Se={class:"relative aspect-2/3 w-full bg-slate-100"},Me={key:0,class:"absolute inset-0 z-20 animate-pulse bg-slate-200"},$e=["src","alt"],Ie={class:"absolute top-2 right-2 z-40 transition-all duration-300 md:group-hover:scale-50 md:group-hover:opacity-0"},Le={class:"absolute inset-0 z-30 hidden items-center justify-center bg-black/40 opacity-0 transition-opacity duration-300 group-hover:opacity-100 md:flex"},Ee={class:"flex w-full translate-y-4 items-center gap-1.5 px-1.5 transition-transform duration-300 group-hover:translate-y-0"},Be={class:"mt-2 flex flex-1 flex-col justify-between px-0.5"},De={class:"mb-1.5 h-10"},Fe=["title","innerHTML"],He={class:"line-clamp-1 text-[13px] font-medium text-gray-500"},Ae={class:"flex items-end justify-between border-t border-gray-100 pt-1.5"},Oe={class:"flex items-center gap-2"},Ne={class:"text-lg font-extrabold text-gray-900"},Ue={key:0,class:"flex flex-col-reverse items-start leading-none"},Ve={class:"mb-0.5 rounded bg-blue/10 px-1 py-px text-[9px] font-bold text-blue"},We={class:"text-[11px] font-medium text-gray-400 line-through"},Pe={key:0,class:"fixed inset-0 z-[100] flex flex-col bg-white"},Qe={class:"sticky top-0 z-10 flex items-center justify-between border-b border-slate-100 bg-white px-4 py-3"},Re={class:"max-w-[150px] truncate text-base font-bold text-slate-900"},qe={class:"flex items-center gap-2"},Ge={key:0,class:"absolute top-1 right-1 flex h-4 w-4 items-center justify-center rounded-full bg-blue text-[10px] font-bold text-white"},Je={class:"flex-1 overflow-y-auto overscroll-contain"},Ke={key:0,class:"animate-pulse space-y-6 px-4 py-6"},Xe={key:1,class:"pb-24"},Ye={class:"bg-slate-50 py-8 text-center"},Ze=["src"],et={class:"px-5 pt-6"},tt={class:"mb-4"},st={class:"rounded bg-blue/10 px-2 py-0.5 text-xs font-bold text-blue"},lt={class:"mt-2 text-2xl font-black text-slate-900"},ot={class:"text-base font-bold text-slate-500"},at={class:"mb-6 flex items-center gap-3"},it={class:"text-3xl font-black text-slate-900"},nt={key:0,class:"flex items-center gap-2"},rt={class:"text-lg text-slate-400 line-through"},ct={class:"rounded-full bg-red-50 px-2.5 py-1 text-xs font-black text-red-500"},dt={class:"mb-6 flex gap-3"},ut={class:"mb-8 grid grid-cols-2 gap-3"},ht={class:"flex items-center gap-2 rounded-xl border border-blue-100 bg-blue-50 p-3"},vt={class:"flex items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 p-3"},xt={class:"mb-8"},pt={class:"flex space-x-6 border-b border-slate-100"},bt=["onClick"],ft={class:"mt-6"},gt={key:0},mt=["innerHTML"],wt={class:"mt-8 space-y-3 rounded-2xl border border-slate-100 bg-slate-50 p-5"},yt={class:"flex items-center gap-3 text-xs text-slate-600"},_t={class:"flex items-center gap-3 text-xs text-slate-600"},kt={key:1},Ct={class:"overflow-hidden rounded-xl border border-slate-100"},zt={class:"font-bold text-slate-500"},jt={class:"font-black text-slate-800"},Tt={key:2},St={class:"flex items-center gap-4"},Mt=["src"],$t={class:"text-base font-black text-slate-900"},It={class:"mt-4 text-sm leading-relaxed text-slate-600"},Lt={key:0,class:"mt-8 border-t border-slate-100 pt-8"},Et={class:"scrollbar-hide flex gap-4 overflow-x-auto pb-4"},Bt=["onClick"],Dt=["src"],Ft={class:"mt-2 line-clamp-1 text-xs font-bold"},Ht={class:"pb-safe fixed right-0 bottom-0 left-0 z-50 border-t border-slate-200 bg-white px-4 py-3 md:hidden"},At={class:"flex items-center gap-3"},Ot=["disabled"],Nt=["disabled"],Ut={key:0,class:"fixed top-20 left-1/2 z-[110] flex -translate-x-1/2 items-center gap-2 rounded-full bg-slate-900 px-6 py-2 text-white shadow-lg"},Vt={class:"text-sm font-bold"},Wt=de({__name:"Card",props:{id:{},name:{},writer:{},category:{},cover_photo:{},price:{},original_price:{},slug:{},highlightQuery:{},highlightVariants:{}},setup(d){const i=d,m=me(),U=ue(),I=p(!1),L=p(!1),V=p(""),w=p(!1),E=p(!1),c=G(null),B=G([]),C=p("summary"),se=p(!1);p(!1);const T=p(!1),h=J(()=>m.items.some(s=>s.id===i.id)),W=J(()=>(U.props.auth?.wishlist_book_ids||[]).includes(i.id)),v=p(W.value);he(W,s=>{v.value=s});function P(s,t){return Math.round((t-s)/t*100)}function S(){m.add({id:i.id,name:i.name,writer:i.writer,cover_photo:i.cover_photo,price:i.price,original_price:i.original_price,slug:i.slug})}function le(){if(T.value)return;T.value=!0,h.value||S();const s=m.items.find(t=>t.id===i.id);s&&!s.selected&&m.toggleSelectedItem(i.id),setTimeout(()=>{_.visit(k("checkout"))},400)}function D(){if(!U.props.auth?.user){_.visit("/login");return}v.value=!v.value,_.post(k("wishlist.toggle"),{book_id:i.id},{preserveScroll:!0,onError:()=>{v.value=!v.value}})}function Q(){const s={title:i.name,text:`Check out this book: ${i.name} by ${i.writer.name}`,url:k("book.show",i.slug)};navigator.share&&navigator.canShare&&navigator.canShare(s)?navigator.share(s).catch(()=>R(s.url)):R(s.url)}function R(s){const t=window.location.origin+s;navigator.clipboard.writeText(t).then(()=>oe("লিংক কপি হয়েছে!"))}function oe(s){V.value=s,L.value=!0,setTimeout(()=>{L.value=!1},3e3)}function M(){window.matchMedia("(max-width: 768px)").matches?window.dispatchEvent(new CustomEvent("open-cart-modal")):_.visit("/cart")}async function ae(s){if(s&&(s.preventDefault(),s.stopPropagation()),!window.matchMedia("(max-width: 768px)").matches){_.visit(k("book.show",i.slug));return}w.value=!0,document.body.style.overflow="hidden";const n=k("book.show",i.slug);window.history.pushState({modalOpen:!0,slug:i.slug},"",n),c.value||await ne()}function ie(){w.value=!1,document.body.style.overflow="",window.history.state?.modalOpen&&window.history.back()}function q(s){w.value&&!s.state?.modalOpen&&(w.value=!1,document.body.style.overflow="")}async function ne(){E.value=!0;try{const s=await ge.get(k("book.show",i.slug),{headers:{Accept:"application/json"}});c.value=s.data.book,B.value=s.data.related_books||[]}catch(s){console.error("Failed to fetch book details",s)}finally{E.value=!1}}const re=(s,t,n=[])=>{if(!t||t.length<2)return s;const f=t.split(/\s+/).filter(z=>z.length>=2);if(f.length===0)return s;let F=s;return[...new Set([...f,...n])].sort((z,H)=>H.length-z.length).forEach(z=>{const H=z.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ce=new RegExp(`(${H})`,"gi");F=F.replace(ce,'<span class="text-blue font-black">$1</span>')}),F},$=s=>{if(!(!s||s==="0"||s===0))return s.toString().startsWith("http")?s.toString():`/storage/${s}`};return ve(()=>{window.addEventListener("popstate",q)}),xe(()=>{window.removeEventListener("popstate",q),w.value&&(document.body.style.overflow="")}),(s,t)=>(l(),r(y,null,[e("div",Ce,[e("div",ze,[e("a",{href:`/book/${d.slug}`,class:"block",onClick:j(ae,["prevent"])},[e("div",Te,[e("div",Se,[I.value?b("",!0):(l(),r("div",Me)),e("img",{src:$(d.cover_photo),alt:d.name,loading:"lazy",decoding:"async",onLoad:t[0]||(t[0]=n=>I.value=!0),class:x(["h-full w-full object-cover transition-opacity duration-300 select-none",I.value?"opacity-100":"opacity-0"])},null,42,$e),e("div",Ie,[e("button",{onClick:j(D,["stop","prevent"]),class:x(["cursor-pointer rounded-full bg-white/90 p-1.5 shadow-sm transition-transform active:scale-95",v.value?"scale-110 text-red-500":"text-slate-400 hover:scale-110 hover:text-red-500"])},[u(a(O),{class:x(["h-4 w-4",{"fill-current":v.value}]),"stroke-width":"2.5"},null,8,["class"])],2)]),e("div",Le,[e("div",Ee,[e("button",{onClick:t[1]||(t[1]=j(n=>h.value?M():S(),["stop","prevent"])),class:x(["flex flex-1 transform cursor-pointer items-center justify-center gap-1 rounded-lg py-2.5 text-[10px] font-bold whitespace-nowrap shadow-xl transition-all active:scale-95",h.value?"bg-blue text-white shadow-blue/20":"bg-white text-slate-900 hover:bg-blue hover:text-white"])},[h.value?(l(),g(a(K),{key:1,class:"size-3"})):(l(),g(a(N),{key:0,class:"size-3"})),e("span",null,o(h.value?"কার্টে দেখুন":"কার্টে যোগ করুন"),1)],2),e("button",{onClick:j(D,["stop","prevent"]),class:x(["flex size-9 shrink-0 cursor-pointer items-center justify-center rounded-lg shadow-xl transition-all active:scale-90",v.value?"bg-red-500 text-white":"bg-white text-slate-900 hover:text-red-500"])},[u(a(O),{class:x(["size-4.5",{"fill-current":v.value}])},null,8,["class"])],2)])])]),t[4]||(t[4]=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 z-10 w-4 bg-gradient-to-r from-black/10 via-black/5 to-transparent"},null,-1))])],8,je)]),e("div",Be,[e("div",null,[e("div",De,[e("h3",{class:"line-clamp-1 text-[15px] font-bold text-gray-900 group-hover:text-blue",title:d.name,innerHTML:d.highlightQuery?re(d.name,d.highlightQuery,d.highlightVariants):d.name},null,8,Fe),e("p",He,o(d.writer.name),1)]),e("div",Ae,[e("div",Oe,[e("span",Ne,"৳"+o(d.price),1),d.original_price?(l(),r("div",Ue,[e("span",Ve,o(P(d.price,d.original_price))+"% OFF ",1),e("span",We,"৳"+o(d.original_price),1)])):b("",!0)])])]),e("button",{onClick:t[2]||(t[2]=j(n=>h.value?M():S(),["stop","prevent"])),class:x(["mt-3 flex w-full cursor-pointer items-center justify-center gap-2 rounded-lg py-2.5 text-sm font-bold transition-transform active:scale-95 md:hidden",h.value?"bg-blue text-white shadow-lg shadow-blue/20":"border border-blue text-blue"])},[h.value?(l(),g(a(K),{key:1,class:"size-4"})):(l(),g(a(N),{key:0,class:"size-4"})),e("span",null,o(h.value?"কার্টে দেখুন":"কার্টে যোগ করুন"),1)],2)])]),(l(),g(pe,{to:"body"},[u(fe,{name:"modal-slide"},{default:be(()=>[w.value?(l(),r("div",Pe,[e("div",Qe,[e("button",{onClick:ie,class:"flex h-10 w-10 cursor-pointer items-center justify-center rounded-full bg-slate-50 active:bg-slate-100"},[u(a(we),{class:"size-6 text-slate-800"})]),e("h2",Re,o(d.name),1),e("div",qe,[e("button",{onClick:Q,class:"flex h-10 w-10 cursor-pointer items-center justify-center"},[u(a(ee),{class:"size-5 text-slate-600"})]),e("button",{onClick:M,class:"relative flex h-10 w-10 cursor-pointer items-center justify-center"},[u(a(X),{class:"size-5 text-slate-600"}),a(m).cartCount>0?(l(),r("span",Ge,o(a(m).cartCount),1)):b("",!0)])])]),e("div",Je,[E.value?(l(),r("div",Ke,[...t[5]||(t[5]=[e("div",{class:"mx-auto aspect-2/3 w-64 rounded-xl bg-slate-200"},null,-1),e("div",{class:"h-8 w-3/4 rounded bg-slate-200"},null,-1)])])):c.value?(l(),r("div",Xe,[e("div",Ye,[e("img",{src:c.value.cover_photo?$(c.value.cover_photo):"/images/placeholder-book.jpg",class:"mx-auto w-40 rounded-lg shadow-xl"},null,8,Ze)]),e("div",et,[e("div",tt,[e("span",st,o(c.value.category?.name),1),e("h1",lt,o(c.value.name),1),e("p",ot," By "+o(c.value.writer?.name),1)]),e("div",at,[e("span",it,"৳"+o(c.value.price),1),c.value.original_price?(l(),r("div",nt,[e("span",rt,"৳"+o(c.value.original_price),1),e("span",ct,o(P(c.value.price,c.value.original_price))+"% OFF ",1)])):b("",!0)]),e("div",dt,[e("button",{onClick:D,class:x(["flex flex-1 cursor-pointer items-center justify-center gap-2 rounded-xl border border-slate-200 py-3 font-bold active:scale-95",v.value?"border-red-100 bg-red-50 text-red-600":"bg-white text-slate-700"])},[u(a(O),{class:x(["size-5",{"fill-current":v.value}])},null,8,["class"]),e("span",null,o(v.value?"সংরক্ষিত":"সেভ করুন"),1)],2),e("button",{onClick:Q,class:"flex h-12 w-12 cursor-pointer items-center justify-center rounded-xl border border-slate-200 bg-white active:scale-95"},[u(a(ee),{class:"size-5 text-slate-600"})])]),e("div",ut,[e("div",ht,[u(a(Y),{class:"size-5 text-blue-600"}),t[6]||(t[6]=e("div",{class:"flex flex-col"},[e("span",{class:"text-xs font-bold"},"দ্রুত ডেলিভারি")],-1))]),e("div",vt,[u(a(ye),{class:"size-5 text-slate-600"}),t[7]||(t[7]=e("div",{class:"flex flex-col"},[e("span",{class:"text-xs font-bold"},"ক্যাশ অন ডেলিভারি")],-1))])]),e("div",xt,[e("div",pt,[(l(),r(y,null,A(["summary","specification","author"],n=>e("button",{key:n,onClick:f=>C.value=n,class:x(["cursor-pointer pb-3 text-sm font-bold transition-colors",C.value===n?"border-b-2 border-blue text-blue":"text-slate-400"])},o(n==="summary"?"সারাংশ":n==="specification"?"স্পেসিফিকেশন":"লেখক"),11,bt)),64))]),e("div",ft,[C.value==="summary"?(l(),r("div",gt,[e("div",{class:"text-sm leading-relaxed text-slate-600",innerHTML:c.value.description},null,8,mt),e("div",wt,[t[10]||(t[10]=e("h4",{class:"mb-3 text-sm font-bold text-slate-900"}," আমাদের সেবা ",-1)),e("div",yt,[u(a(_e),{class:"size-4 text-slate-700"}),t[8]||(t[8]=e("span",null,"১০০% অরিজিনাল পণ্য",-1))]),e("div",_t,[u(a(Y),{class:"size-4 text-blue-500"}),t[9]||(t[9]=e("span",null,"সারাদেশে হোম ডেলিভারি",-1))])])])):C.value==="specification"?(l(),r("div",kt,[e("div",Ct,[(l(!0),r(y,null,A(c.value.specification,(n,f)=>(l(),r("div",{key:f,class:"flex justify-between px-4 py-3 text-sm even:bg-slate-50"},[e("span",zt,o(f),1),e("span",jt,o(n),1)]))),128))])])):C.value==="author"?(l(),r("div",Tt,[e("div",St,[e("img",{src:c.value.writer?.photo?$(c.value.writer.photo):"/images/placeholder-author.jpg",class:"h-16 w-16 rounded-full bg-slate-100 object-cover"},null,8,Mt),e("div",null,[e("h4",$t,o(c.value.writer?.name),1),t[11]||(t[11]=e("p",{class:"text-xs font-bold text-slate-500"}," লেখক ",-1))])]),e("div",It,o(c.value.writer?.biography||"তথ্য শীঘ্রই আসবে।"),1)])):b("",!0)])]),B.value.length>0?(l(),r("div",Lt,[t[12]||(t[12]=e("h3",{class:"mb-4 text-lg font-black text-slate-900"}," সম্পর্কিত বই ",-1)),e("div",Et,[(l(!0),r(y,null,A(B.value,n=>(l(),r("div",{key:n.id,class:"w-28 shrink-0"},[e("div",{onClick:f=>a(_).visit(`/book/${n.slug}`),class:"aspect-2/3 cursor-pointer overflow-hidden rounded-lg bg-slate-100"},[e("img",{src:$(n.cover_photo),class:"h-full w-full object-cover",loading:"lazy"},null,8,Dt)],8,Bt),e("p",Ft,o(n.name),1)]))),128))])])):b("",!0)])])):b("",!0)]),e("div",Ht,[e("div",At,[e("button",{onClick:t[3]||(t[3]=n=>h.value?M():S()),disabled:se.value,class:x(["flex h-12 flex-[1.4] cursor-pointer items-center justify-center gap-2 rounded-xl border border-slate-200 bg-white text-sm font-bold text-slate-700 shadow-sm transition-all active:bg-slate-50",h.value?"border-emerald-500 bg-emerald-50 text-emerald-600":"hover:border-blue hover:text-blue"])},[h.value?(l(),g(a(Z),{key:1,class:"size-5"})):(l(),g(a(N),{key:0,class:"size-5"})),e("span",null,o(h.value?"কার্টে আছে":"কার্ডে যুক্ত করুন"),1)],10,Ot),e("button",{onClick:le,disabled:T.value,class:"flex h-12 flex-1 cursor-pointer items-center justify-center gap-2 rounded-xl bg-blue text-sm font-bold text-white shadow-lg shadow-blue/30 transition-all hover:bg-blue-600 active:scale-95 disabled:cursor-not-allowed disabled:opacity-80"},[T.value?(l(),r(y,{key:0},[t[13]||(t[13]=e("span",{class:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"},null,-1)),t[14]||(t[14]=e("span",null,"প্রসেসিং...",-1))],64)):(l(),r(y,{key:1},[u(a(X),{class:"size-5"}),t[15]||(t[15]=e("span",null,"কিনুন",-1))],64))],8,Nt)])]),L.value?(l(),r("div",Ut,[u(a(Z),{class:"size-4 text-green-400"}),e("span",Vt,o(V.value),1)])):b("",!0)])):b("",!0)]),_:1})]))],64))}}),Kt=ke(Wt,[["__scopeId","data-v-483c8f13"]]);export{Kt as C,ee as S,N as a};
